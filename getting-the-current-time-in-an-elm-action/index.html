<!DOCTYPE html>
<html class="min-h-full min-w-[250px]">
  <head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1" name="viewport"/>
    <title>Getting the current time in an Elm Action</title>
    <link href="https://unpkg.com/smartphoto@1.1.0/css/smartphoto.min.css" rel="stylesheet"/>

    <link href="https://unpkg.com/flickity@2/dist/flickity.min.css" rel="stylesheet">

    <link href="https://fonts.googleapis.com/css?family=Poppins:400,700" rel="stylesheet"/>
    <link href="/assets/css/tailwind.css" rel="stylesheet"/>
    <link href="/assets/css/native.css" rel="stylesheet"/>
    <link href="/assets/css/styles.css" rel="stylesheet"/>

    <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Getting the current time in an Elm Action | Keen Development</title>
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="Getting the current time in an Elm Action" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="I often find myself needing to get the current time in an Elm action in order to write something to the model. However, since getting the time is a Task you would normally need two separate Msgs in order to implement this." />
<meta property="og:description" content="I often find myself needing to get the current time in an Elm action in order to write something to the model. However, since getting the time is a Task you would normally need two separate Msgs in order to implement this." />
<meta property="og:site_name" content="Keen Development" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2016-08-24T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Getting the current time in an Elm Action" />
<script type="application/ld+json">
{"datePublished":"2016-08-24T00:00:00+00:00","dateModified":"2016-08-24T00:00:00+00:00","description":"I often find myself needing to get the current time in an Elm action in order to write something to the model. However, since getting the time is a Task you would normally need two separate Msgs in order to implement this.","url":"/getting-the-current-time-in-an-elm-action/","mainEntityOfPage":{"@type":"WebPage","@id":"/getting-the-current-time-in-an-elm-action/"},"@type":"BlogPosting","headline":"Getting the current time in an Elm Action","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body class="max-w-screen-xl mx-auto bg-lightgray overscroll-y-none">
    <div class="absolute left-0 right-0 h-12 shadow-md bg-code">
  <div class="flex justify-center w-full px-6 py-3 sm:justify-between">
    <a href="/">
      <img class="hidden h-7 sm:inline" src="/assets/images/Keen_bold_neg%201.svg"/>
    </a>
    <nav class="flex items-center text-base">
  <ol class="flex gap-4">
    
      <li class="text-white">
        <a href="/">Home</a>
      </li>
    
      <li class="text-white">
        <a href="/contact">Contact</a>
      </li>
    
      <li class="text-white">
        <a href="https://www.github.com/ccapndave">Github</a>
      </li>
    
  </ol>
</nav>
  </div>
</div>

<div class="px-5 pt-20 m-auto max-w-prose">
  <header class="flex justify-between">
    <div class="text-xl font-bold tracking-wide">Getting the current time in an Elm Action<span class="font-normal text-orange">_</span>
    </div>
  </header>

  

  <div class="flex items-center text-sm font-normal text-darkgray whitespace-nowrap">
    Aug 24, 2016
  </div>

  <article class="my-8 prose-sm prose text-green-700 sm:prose">
  <p>I often find myself needing to get the current time in an Elm action in order to write something to the model. However, since getting the time is a Task you would normally need two separate <code class="language-plaintext highlighter-rouge">Msg</code>s in order to implement this.</p>

<p>However, I came up with this little pattern that allows you to do it all in a single action:</p>

<div class="language-elm highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">type</span> <span class="kt">Msg</span>
  <span class="o">=</span> <span class="kt">ActionThatNeedsTime</span> <span class="p">(</span><span class="kt">Maybe</span> <span class="kt">Time</span><span class="p">)</span>

<span class="n">update</span> <span class="p">:</span> <span class="kt">Msg</span> <span class="o">-&gt;</span> <span class="kt">Model</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="kt">Model</span><span class="o">,</span> <span class="kt">Cmd</span> <span class="kt">Msg</span><span class="p">)</span>
<span class="n">update</span> <span class="n">msg</span> <span class="n">model</span> <span class="o">=</span>
  <span class="k">case</span> <span class="n">msg</span> <span class="k">of</span>
    <span class="kt">ActionThatNeedsTime</span> <span class="p">(</span><span class="kt">Nothing</span><span class="p">)</span> <span class="o">-&gt;</span>
      <span class="n">model</span> <span class="o">!</span>
      <span class="p">[</span> <span class="kt">Task</span><span class="o">.</span><span class="n">perform</span> <span class="kt">ActionThatNeedsTime</span> <span class="kt">ActionThatNeedsTime</span> <span class="p">(</span><span class="kt">Task</span><span class="o">.</span><span class="n">map</span> <span class="kt">Just</span> <span class="kt">Time</span><span class="o">.</span><span class="n">now</span><span class="p">)</span>
      <span class="p">]</span>

    <span class="kt">ActionThatNeedsTime</span> <span class="p">(</span><span class="kt">Just</span> <span class="n">time</span><span class="p">)</span> <span class="o">-&gt;</span>
      <span class="p">{</span> <span class="n">model</span> <span class="o">|</span> <span class="n">currentTime</span> <span class="o">=</span> <span class="n">time</span> <span class="p">}</span> <span class="o">!</span> <span class="p">[]</span>
</code></pre></div></div>

<p>This uses <code class="language-plaintext highlighter-rouge">Task.map</code> to turn the result of <code class="language-plaintext highlighter-rouge">Time.now</code> into a <code class="language-plaintext highlighter-rouge">Maybe</code>, and since we know that <code class="language-plaintext highlighter-rouge">Time.now</code> can never fail we can just use the same action for the failure clause of <code class="language-plaintext highlighter-rouge">Task.perform</code> to save having to define a <code class="language-plaintext highlighter-rouge">Noop</code>.</p>

<p>Then, in order to use this simply call <code class="language-plaintext highlighter-rouge">ActionThatNeedsTime Nothing</code> and trust in the update function to retrieve the current time for you.  As an added bonus if you happen to know the time already then you can pass that in directly.</p>

</article>
</div>

  </body>

  <script src="https://unpkg.com/smartphoto@1.1.0/js/smartphoto.min.js"></script>
  <script src="https://unpkg.com/flickity@2/dist/flickity.pkgd.min.js"></script>
</html>
