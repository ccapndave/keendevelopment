<!DOCTYPE html>
<html class="min-h-full min-w-[250px]">
  <head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1" name="viewport"/>
    <title>PureMVC Tutorial - Flex, PureMVC, Jabber and XIFF 3: Part 8 - The Roster View & Mediator</title>
    <link href="https://unpkg.com/smartphoto@1.1.0/css/smartphoto.min.css" rel="stylesheet"/>

    <link href="https://unpkg.com/flickity@2/dist/flickity.min.css" rel="stylesheet">

    <link href="https://fonts.googleapis.com/css?family=Poppins:400,700" rel="stylesheet"/>
    <link href="/assets/css/tailwind.css" rel="stylesheet"/>
    <link href="/assets/css/native.css" rel="stylesheet"/>
    <link href="/assets/css/styles.css" rel="stylesheet"/>

    <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>PureMVC Tutorial - Flex, PureMVC, Jabber and XIFF 3: Part 8 - The Roster View &amp; Mediator | Keen Development</title>
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="PureMVC Tutorial - Flex, PureMVC, Jabber and XIFF 3: Part 8 - The Roster View &amp; Mediator" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Introduction Part 1 - Frameworks Part 2 - Directory structure Part 3 - Application and ApplicationFacade Part 4 - Notifications, Commands &amp; Use Cases Part 5 - Model &amp; Proxy Part 6 - The Application View &amp; Mediator Part 7 - The Login View &amp; Mediator Part 8 - The Roster View &amp; Mediator Part 9 - The Chat View &amp; Mediator Conclusion, Demo &amp; Downloads" />
<meta property="og:description" content="Introduction Part 1 - Frameworks Part 2 - Directory structure Part 3 - Application and ApplicationFacade Part 4 - Notifications, Commands &amp; Use Cases Part 5 - Model &amp; Proxy Part 6 - The Application View &amp; Mediator Part 7 - The Login View &amp; Mediator Part 8 - The Roster View &amp; Mediator Part 9 - The Chat View &amp; Mediator Conclusion, Demo &amp; Downloads" />
<meta property="og:site_name" content="Keen Development" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2008-07-19T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="PureMVC Tutorial - Flex, PureMVC, Jabber and XIFF 3: Part 8 - The Roster View &amp; Mediator" />
<script type="application/ld+json">
{"datePublished":"2008-07-19T00:00:00+00:00","dateModified":"2008-07-19T00:00:00+00:00","description":"Introduction Part 1 - Frameworks Part 2 - Directory structure Part 3 - Application and ApplicationFacade Part 4 - Notifications, Commands &amp; Use Cases Part 5 - Model &amp; Proxy Part 6 - The Application View &amp; Mediator Part 7 - The Login View &amp; Mediator Part 8 - The Roster View &amp; Mediator Part 9 - The Chat View &amp; Mediator Conclusion, Demo &amp; Downloads","url":"/puremvc-tutorial-flex-puremvc-jabber-and-xiff-3-part-8-the-roster-view-mediator/","mainEntityOfPage":{"@type":"WebPage","@id":"/puremvc-tutorial-flex-puremvc-jabber-and-xiff-3-part-8-the-roster-view-mediator/"},"@type":"BlogPosting","headline":"PureMVC Tutorial - Flex, PureMVC, Jabber and XIFF 3: Part 8 - The Roster View &amp; Mediator","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body class="max-w-screen-xl mx-auto bg-lightgray overscroll-y-none">
    <div class="absolute left-0 right-0 h-12 shadow-md bg-code">
  <div class="flex justify-center w-full px-6 py-3 sm:justify-between">
    <a href="/">
      <img class="hidden h-7 sm:inline" src="/assets/images/Keen_bold_neg%201.svg"/>
    </a>
    <nav class="flex items-center text-base">
  <ol class="flex gap-4">
    
      <li class="text-white">
        <a href="/">Home</a>
      </li>
    
      <li class="text-white">
        <a href="/contact">Contact</a>
      </li>
    
      <li class="text-white">
        <a href="https://www.github.com/ccapndave">Github</a>
      </li>
    
  </ol>
</nav>
  </div>
</div>

<div class="px-5 pt-20 m-auto max-w-prose">
  <header class="flex justify-between">
    <div class="text-xl font-bold tracking-wide">PureMVC Tutorial - Flex, PureMVC, Jabber and XIFF 3: Part 8 - The Roster View & Mediator<span class="font-normal text-orange">_</span>
    </div>
  </header>

  
  <div class="flex justify-between">
    <ul class="flex flex-wrap my-2 text-xs divide-x-2 font-extralight">
      
        <li>
          <span class="text-orange  mr-1 ">BUDDY LIST</span>
        </li>
      
        <li>
          <span class="text-orange  mx-1 ">CONNECT</span>
        </li>
      
        <li>
          <span class="text-orange  mx-1 ">JABBER</span>
        </li>
      
        <li>
          <span class="text-orange  mx-1 ">JABBER FRIENDS</span>
        </li>
      
        <li>
          <span class="text-orange  mx-1 ">PUREMVC</span>
        </li>
      
        <li>
          <span class="text-orange  mx-1 ">REGISTERMEDIATOR</span>
        </li>
      
        <li>
          <span class="text-orange  mx-1 ">ROSTER</span>
        </li>
      
        <li>
          <span class="text-orange  mx-1 ">TUTORIAL</span>
        </li>
      
        <li>
          <span class="text-orange  ml-1 ">XMPP</span>
        </li>
      
    </ul>
  </div>


  <div class="flex items-center text-sm font-normal text-darkgray whitespace-nowrap">
    Jul 19, 2008
  </div>

  <article class="my-8 prose-sm prose text-green-700 sm:prose">
  <ul>
  <li><a href="/puremvc-tutorial-flex-puremvc-jabber-and-xiff-3-introduction/">Introduction</a></li>
  <li><a href="/puremvc-tutorial-flex-puremvc-jabber-and-xiff-3-part-1-frameworks/">Part 1 - Frameworks</a></li>
  <li><a href="/puremvc-tutorial-flex-puremvc-jabber-and-xiff-3-part-2-directory-structure/">Part 2 - Directory structure</a></li>
  <li><a href="/puremvc-tutorial-flex-puremvc-jabber-and-xiff-3-part-3-application-and-applicationfacade/">Part 3 - Application and ApplicationFacade</a></li>
  <li><a href="/puremvc-tutorial-flex-puremvc-jabber-and-xiff-3-part-4-notifications-commands-use-cases/">Part 4 - Notifications, Commands &amp; Use Cases</a></li>
  <li><a href="/puremvc-tutorial-flex-puremvc-jabber-and-xiff-3-part-5-model-proxy/">Part 5 - Model &amp; Proxy</a></li>
  <li><a href="/puremvc-tutorial-flex-puremvc-jabber-and-xiff-3-part-6-the-application-view-mediator/">Part 6 - The Application View &amp; Mediator</a></li>
  <li><a href="/puremvc-tutorial-flex-puremvc-jabber-and-xiff-3-part-7-the-login-view-mediator/">Part 7 - The Login View &amp; Mediator</a></li>
  <li><a href="/puremvc-tutorial-flex-puremvc-jabber-and-xiff-3-part-8-the-roster-view-mediator/">Part 8 - The Roster View &amp; Mediator</a></li>
  <li><a href="/puremvc-tutorial-flex-puremvc-jabber-and-xiff-3-part-9-the-chat-view-mediator/">Part 9 - The Chat View &amp; Mediator</a></li>
  <li><a href="/puremvc-tutorial-flex-puremvc-jabber-and-xiff-3-conclusion-demo-downloads/">Conclusion, Demo &amp; Downloads</a></li>
</ul>

<p>By now you’re probably becoming a bit of an old hand at this PureMVC lark, so I’m going to be explaining stuff in a bit less detail.  If you get stuck re-read the previous sections until you have everything clear in your head.</p>

<p>The Roster is very simple.  We want a Flex DataGrid displaying usernames and login status and we need a ‘Start chat…’ button that opens a chat window.</p>

<p>In order to implement this view we’ll need a new event called <em>ChatEvent.as</em>.  The <em>JID</em> class is part of the XIFF framework and is used to identify a Jabber user.  The <em>RosterView</em> will only use START_CHAT, but we’ll need SEND_MESSAGE in the next and final view.</p>

<div class="language-as3 highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">package</span> <span class="nx">org</span><span class="p">.</span><span class="nx">davekeen</span><span class="p">.</span><span class="nx">xiffer</span><span class="p">.</span><span class="nx">events</span> <span class="p">{</span>
  <span class="kr">import</span> <span class="nx">flash</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">Event</span><span class="o">;</span>
  <span class="kr">import</span> <span class="nx">org</span><span class="p">.</span><span class="nx">jivesoftware</span><span class="p">.</span><span class="nx">xiff</span><span class="p">.</span><span class="nx">core</span><span class="p">.</span><span class="nx">JID</span><span class="o">;</span>

  <span class="cm">/**
   * This event is related to the ChatViews
   * 
   * @author Dave Keen
   */</span>
  <span class="kr">public</span> <span class="kr">class</span> <span class="nx">ChatEvent</span> <span class="kr">extends</span> <span class="nx">Event</span> <span class="p">{</span>

    <span class="kr">public</span> <span class="kr">static</span> <span class="kr">const</span> <span class="nx">START_CHAT</span><span class="o">:</span><span class="nx">String</span> <span class="o">=</span> <span class="s2">"start_chat"</span><span class="o">;</span>
    <span class="kr">public</span> <span class="kr">static</span> <span class="kr">const</span> <span class="nx">SEND_MESSAGE</span><span class="o">:</span><span class="nx">String</span> <span class="o">=</span> <span class="s2">"send_message"</span><span class="o">;</span>

    <span class="kr">private</span> <span class="kd">var</span> <span class="nx">jid</span><span class="o">:</span><span class="nx">JID</span><span class="o">;</span>
    <span class="kr">private</span> <span class="kd">var</span> <span class="nx">message</span><span class="o">:</span><span class="nx">String</span><span class="o">;</span>

    <span class="kr">public</span> <span class="kd">function</span> <span class="nx">ChatEvent</span><span class="p">(</span><span class="nx">type</span><span class="o">:</span><span class="nx">String</span><span class="p">,</span> <span class="nx">jid</span><span class="o">:</span><span class="nx">JID</span><span class="p">,</span> <span class="nx">message</span><span class="o">:</span><span class="nx">String</span> <span class="o">=</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">bubbles</span><span class="o">:</span><span class="nx">Boolean</span><span class="o">=</span><span class="kc">false</span><span class="p">,</span> <span class="nx">cancelable</span><span class="o">:</span><span class="nx">Boolean</span><span class="o">=</span><span class="kc">false</span><span class="p">)</span> <span class="p">{</span> 
      <span class="kr">super</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">bubbles</span><span class="p">,</span> <span class="nx">cancelable</span><span class="p">)</span><span class="o">;</span>

      <span class="k">this</span><span class="p">.</span><span class="nx">jid</span> <span class="o">=</span> <span class="nx">jid</span><span class="o">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">message</span> <span class="o">=</span> <span class="nx">message</span><span class="o">;</span>
    <span class="p">}</span> 

    <span class="kr">public</span> <span class="kd">function</span> <span class="nx">getJID</span><span class="p">()</span><span class="o">:</span><span class="nx">JID</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">jid</span><span class="o">;</span>
    <span class="p">}</span>

    <span class="kr">public</span> <span class="kd">function</span> <span class="nx">getMessage</span><span class="p">()</span><span class="o">:</span><span class="nx">String</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">message</span><span class="o">;</span>
    <span class="p">}</span>

    <span class="kr">public</span> <span class="kr">override</span> <span class="kd">function</span> <span class="nx">clone</span><span class="p">()</span><span class="o">:</span><span class="nx">Event</span> <span class="p">{</span> 
      <span class="k">return</span> <span class="k">new</span> <span class="nx">ChatEvent</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">jid</span><span class="p">,</span> <span class="nx">message</span><span class="p">,</span> <span class="nx">bubbles</span><span class="p">,</span> <span class="nx">cancelable</span><span class="p">)</span><span class="o">;</span>
    <span class="p">}</span> 

  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>We’ll also need to define one new notification in <em>ApplicationFacade.as</em> called OPEN_CHAT_WINDOW:</p>

<div class="language-as3 highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">public</span> <span class="kr">static</span> <span class="kr">const</span> <span class="nx">OPEN_CHAT_WINDOW</span><span class="o">:</span><span class="nx">String</span> <span class="o">=</span> <span class="s2">"open_chat_window"</span><span class="o">;</span>
</code></pre></div></div>

<p>Next we create our <em>RosterView.mxml</em> file in <em>components</em>:</p>

<div class="language-mxml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;mx:Canvas</span> <span class="na">xmlns:mx=</span><span class="s">"http://www.adobe.com/2006/mxml"</span> <span class="na">xmlns=</span><span class="s">"*"</span> <span class="na">width=</span><span class="s">"100%"</span> <span class="na">height=</span><span class="s">"100%"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;mx:Script&gt;</span>
  <span class="cp">&lt;![CDATA[</span>
  <span class="kr">import</span> <span class="nx">flash</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">Event</span><span class="o">;</span>
  <span class="kr">import</span> <span class="nx">mx</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ListEvent</span><span class="o">;</span>
  <span class="kr">import</span> <span class="nx">org</span><span class="p">.</span><span class="nx">davekeen</span><span class="p">.</span><span class="nx">xiffer</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ChatEvent</span><span class="o">;</span>
  <span class="kr">import</span> <span class="nx">org</span><span class="p">.</span><span class="nx">jivesoftware</span><span class="p">.</span><span class="nx">xiff</span><span class="p">.</span><span class="nx">core</span><span class="p">.</span><span class="nx">JID</span><span class="o">;</span>

  <span class="kr">private</span> <span class="kd">function</span> <span class="nx">onChatClick</span><span class="p">()</span><span class="o">:</span><span class="nb">void</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">rosterGrid</span><span class="p">.</span><span class="nx">selectedItem</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Get the selected item and convert it to a JID</span>
      <span class="kd">var</span> <span class="nx">jid</span><span class="o">:</span><span class="nx">JID</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">JID</span><span class="p">(</span><span class="nx">rosterGrid</span><span class="p">.</span><span class="nx">selectedItem</span><span class="p">.</span><span class="nx">jid</span><span class="p">)</span><span class="o">;</span>

      <span class="c1">// Dispatch an event for the mediator</span>
      <span class="nx">dispatchEvent</span><span class="p">(</span><span class="k">new</span> <span class="nx">ChatEvent</span><span class="p">(</span><span class="nx">ChatEvent</span><span class="p">.</span><span class="nx">START_CHAT</span><span class="p">,</span> <span class="nx">jid</span><span class="p">))</span><span class="o">;</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="cp">]]&gt;</span>
  <span class="nt">&lt;/mx:Script&gt;</span>
  <span class="nt">&lt;mx:TitleWindow</span> <span class="na">id=</span><span class="s">"titleWindow"</span> <span class="na">title=</span><span class="s">"Buddy list"</span> <span class="na">enabled=</span><span class="s">"false"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;mx:DataGrid</span> <span class="na">id=</span><span class="s">"rosterGrid"</span> <span class="na">editable=</span><span class="s">"false"</span> <span class="na">width=</span><span class="s">"160"</span> <span class="na">height=</span><span class="s">"300"</span> <span class="na">showHeaders=</span><span class="s">"true"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;mx:columns&gt;</span>
        <span class="nt">&lt;mx:DataGridColumn</span> <span class="na">dataField=</span><span class="s">"displayName"</span> <span class="na">headerText=</span><span class="s">"Username"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;mx:DataGridColumn</span> <span class="na">dataField=</span><span class="s">"online"</span> <span class="na">width=</span><span class="s">"55"</span> <span class="na">headerText=</span><span class="s">"Online?"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;/mx:columns&gt;</span>
    <span class="nt">&lt;/mx:DataGrid&gt;</span>
    <span class="nt">&lt;mx:Button</span> <span class="na">width=</span><span class="s">"160"</span> <span class="na">label=</span><span class="s">"Chat..."</span> <span class="na">click=</span><span class="s">"onChatClick()"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/mx:TitleWindow&gt;</span>
<span class="nt">&lt;/mx:Canvas&gt;</span>
</code></pre></div></div>

<p>Add this component to the display list of our top-level <em>Application.mxml</em> component so that the *<mx:Canvas>* component now reads:</mx:Canvas></p>

<div class="language-mxml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;mx:Canvas</span> <span class="na">left=</span><span class="s">"0"</span> <span class="na">top=</span><span class="s">"0"</span> <span class="na">right=</span><span class="s">"0"</span> <span class="na">bottom=</span><span class="s">"0"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;view:LoginView</span> <span class="na">id=</span><span class="s">"loginView"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;view:RosterView</span> <span class="na">y=</span><span class="s">"30"</span> <span class="na">id=</span><span class="s">"rosterView"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/mx:Canvas&gt;</span>
</code></pre></div></div>

<p>Now we need to create <em>RosterMediator.as</em> in the <em>view</em> folder, and register it with PureMVC.  Using the rule we applied in the previous section we can see that we need to do this registration in <em>ApplicationMediator.as</em>:</p>

<div class="language-as3 highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">public</span> <span class="kd">function</span> <span class="nx">ApplicationMediator</span><span class="p">(</span><span class="nx">viewComponent</span><span class="o">:</span><span class="nb">Object</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// pass the viewComponent to the superclass where </span>
  <span class="c1">// it will be stored in the inherited viewComponent property</span>
  <span class="kr">super</span><span class="p">(</span><span class="nx">NAME</span><span class="p">,</span> <span class="nx">viewComponent</span><span class="p">)</span><span class="o">;</span>

  <span class="nx">facade</span><span class="p">.</span><span class="nx">registerMediator</span><span class="p">(</span><span class="k">new</span> <span class="nx">LoginMediator</span><span class="p">(</span><span class="nx">application</span><span class="p">.</span><span class="nx">loginView</span><span class="p">))</span><span class="o">;</span>
  <span class="nx">facade</span><span class="p">.</span><span class="nx">registerMediator</span><span class="p">(</span><span class="k">new</span> <span class="nx">RosterMediator</span><span class="p">(</span><span class="nx">application</span><span class="p">.</span><span class="nx">rosterView</span><span class="p">))</span><span class="o">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>All that is left now is to configure our mediator using the same steps as in the previous section.</p>

<h4 id="1-add-listeners">1. Add listeners</h4>

<p><em>RosterView.mxml</em> dispatches only ChatEvent.START_CHAT so let’s add a listener in the constructor:</p>

<div class="language-as3 highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">public</span> <span class="kd">function</span> <span class="nx">RosterMediator</span><span class="p">(</span><span class="nx">viewComponent</span><span class="o">:</span><span class="nb">Object</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// pass the viewComponent to the superclass where </span>
  <span class="c1">// it will be stored in the inherited viewComponent property</span>
  <span class="kr">super</span><span class="p">(</span><span class="nx">NAME</span><span class="p">,</span> <span class="nx">viewComponent</span><span class="p">)</span><span class="o">;</span>

  <span class="nx">rosterView</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="nx">ChatEvent</span><span class="p">.</span><span class="nx">START_CHAT</span><span class="p">,</span> <span class="nx">onStartChat</span><span class="p">)</span><span class="o">;</span>
<span class="p">}</span>

<span class="kr">private</span> <span class="kd">function</span> <span class="nx">onStartChat</span><span class="p">(</span><span class="nx">chatEvent</span><span class="o">:</span><span class="nx">ChatEvent</span><span class="p">)</span><span class="o">:</span><span class="nb">void</span> <span class="p">{</span> <span class="p">}</span>
</code></pre></div></div>

<h4 id="2-add-notifications">2. Add notifications</h4>

<p>The Roster window need to enable and disable depending on whether or not the user is connected to a jabber server, and also needs to fill in the DataGrid with the list of buddies.  To achieve these goals the mediator will need to register an interest in <strong>ApplicationFacade.VALID_LOGIN</strong> and <strong>ApplicationFacade.DISCONNECT</strong>.</p>

<div class="language-as3 highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">override</span> <span class="kr">public</span> <span class="kd">function</span> <span class="nx">listNotificationInterests</span><span class="p">()</span><span class="o">:</span><span class="nx">Array</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">[</span>
    <span class="nx">ApplicationFacade</span><span class="p">.</span><span class="nx">VALID_LOGIN</span><span class="p">,</span>
    <span class="nx">ApplicationFacade</span><span class="p">.</span><span class="nx">DISCONNECT</span>
  <span class="p">]</span><span class="o">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>And here are the clauses for the switch statement:</p>

<div class="language-as3 highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">override</span> <span class="kr">public</span> <span class="kd">function</span> <span class="nx">handleNotification</span><span class="p">(</span><span class="nx">note</span><span class="o">:</span><span class="nx">INotification</span><span class="p">)</span><span class="o">:</span><span class="nb">void</span> <span class="p">{</span>
  <span class="k">switch</span> <span class="p">(</span><span class="nx">note</span><span class="p">.</span><span class="nx">getName</span><span class="p">())</span> <span class="p">{</span>
    <span class="k">case</span> <span class="nx">ApplicationFacade</span><span class="p">.</span><span class="nx">VALID_LOGIN</span><span class="o">:</span>
      <span class="k">break</span><span class="o">;</span>
    <span class="k">case</span> <span class="nx">ApplicationFacade</span><span class="p">.</span><span class="nx">DISCONNECT</span><span class="o">:</span>
      <span class="k">break</span><span class="o">;</span>
    <span class="k">default</span><span class="o">:</span>
      <span class="k">break</span><span class="o">;</span>        
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="3-fill-in-the-event-listeners-and-switch-clauses">3. Fill in the event listeners and switch clauses</h4>

<p>Firstly we’ll fill in the <strong>onStartChat</strong> event listener.  This will very simply send an <strong>ApplicationFacade.OPEN_CHAT_WINDOW</strong> with the JID as the argument.  Although we could have passed the ChatEvent itself as a parameter in this case there is no need to use a value object as to open a chat window we only require a single item of information - the JID.</p>

<div class="language-as3 highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">private</span> <span class="kd">function</span> <span class="nx">onStartChat</span><span class="p">(</span><span class="nx">chatEvent</span><span class="o">:</span><span class="nx">ChatEvent</span><span class="p">)</span><span class="o">:</span><span class="nb">void</span> <span class="p">{</span>
  <span class="nx">sendNotification</span><span class="p">(</span><span class="nx">ApplicationFacade</span><span class="p">.</span><span class="nx">OPEN_CHAT_WINDOW</span><span class="p">,</span> <span class="nx">chatEvent</span><span class="p">.</span><span class="nx">getJID</span><span class="p">())</span><span class="o">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>You’ll notice that the <strong>ApplicationFacade.OPEN_CHAT_WINDOW</strong> notification is not mapped to a command - this is because the only responder to the notification will be the ChatMediator that we are about to create in the next section so there is no need to have a command.  However, one of the beautiful things about PureMVC is that if it turned out later in the development that this notification needed to affect the model in some way we could implement this merely by adding a new command and registering it, and there will be no need to make any changes to the rest of the application.</p>

<p>Compile and run the application and enjoy the working buddy list!  <a href="/puremvc-tutorial-flex-puremvc-jabber-and-xiff-3-part-9-the-chat-view-mediator/">Only one view left to go…</a></p>

</article>
</div>

  </body>

  <script src="https://unpkg.com/smartphoto@1.1.0/js/smartphoto.min.js"></script>
  <script src="https://unpkg.com/flickity@2/dist/flickity.pkgd.min.js"></script>
</html>
