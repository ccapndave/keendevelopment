<!DOCTYPE html>
<html class="min-h-full min-w-[250px]">
  <head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1" name="viewport"/>
    <title>Flextrine Tutorial – CRUD in a simple Flex 4 address book: Updating entities</title>
    <link href="https://unpkg.com/smartphoto@1.1.0/css/smartphoto.min.css" rel="stylesheet"/>

    <link href="https://unpkg.com/flickity@2/dist/flickity.min.css" rel="stylesheet">

    <link href="https://fonts.googleapis.com/css?family=Poppins:400,700" rel="stylesheet"/>
    <link href="/assets/css/tailwind.css" rel="stylesheet"/>
    <link href="/assets/css/native.css" rel="stylesheet"/>
    <link href="/assets/css/styles.css" rel="stylesheet"/>

    <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Flextrine Tutorial – CRUD in a simple Flex 4 address book: Updating entities | Keen Development</title>
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="Flextrine Tutorial – CRUD in a simple Flex 4 address book: Updating entities" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Introduction Setting up the server Creating the entities Creating the database schema Loading the entities Creating new entities Deleting entities Updating entities Conclusion" />
<meta property="og:description" content="Introduction Setting up the server Creating the entities Creating the database schema Loading the entities Creating new entities Deleting entities Updating entities Conclusion" />
<meta property="og:site_name" content="Keen Development" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2010-08-03T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Flextrine Tutorial – CRUD in a simple Flex 4 address book: Updating entities" />
<script type="application/ld+json">
{"datePublished":"2010-08-03T00:00:00+00:00","dateModified":"2010-08-03T00:00:00+00:00","description":"Introduction Setting up the server Creating the entities Creating the database schema Loading the entities Creating new entities Deleting entities Updating entities Conclusion","url":"/flextrine-tutorial-crud-in-a-simple-flex-4-address-book-updating-entities/","mainEntityOfPage":{"@type":"WebPage","@id":"/flextrine-tutorial-crud-in-a-simple-flex-4-address-book-updating-entities/"},"@type":"BlogPosting","headline":"Flextrine Tutorial – CRUD in a simple Flex 4 address book: Updating entities","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body class="max-w-screen-xl mx-auto bg-lightgray overscroll-y-none">
    <div class="absolute left-0 right-0 h-12 shadow-md bg-code">
  <div class="flex justify-center w-full px-6 py-3 sm:justify-between">
    <a href="/">
      <img class="hidden h-7 sm:inline" src="/assets/images/Keen_bold_neg%201.svg"/>
    </a>
    <nav class="flex items-center text-base">
  <ol class="flex gap-4">
    
      <li class="text-white">
        <a href="/">Home</a>
      </li>
    
      <li class="text-white">
        <a href="/contact">Contact</a>
      </li>
    
      <li class="text-white">
        <a href="https://www.github.com/ccapndave">Github</a>
      </li>
    
  </ol>
</nav>
  </div>
</div>

<div class="px-5 pt-20 m-auto max-w-prose">
  <header class="flex justify-between">
    <div class="text-xl font-bold tracking-wide">Flextrine Tutorial – CRUD in a simple Flex 4 address book: Updating entities<span class="font-normal text-orange">_</span>
    </div>
  </header>

  
  <div class="flex justify-between">
    <ul class="flex flex-wrap my-2 text-xs divide-x-2 font-extralight">
      
        <li>
          <span class="text-orange  mr-1 ">DATABINDING</span>
        </li>
      
        <li>
          <span class="text-orange  mx-1 ">DOCTRINE 2</span>
        </li>
      
        <li>
          <span class="text-orange  mx-1 ">FLEXTRINE</span>
        </li>
      
        <li>
          <span class="text-orange  mx-1 ">FLUSH</span>
        </li>
      
        <li>
          <span class="text-orange  mx-1 ">MERGING</span>
        </li>
      
        <li>
          <span class="text-orange  mx-1 ">NOTIFY</span>
        </li>
      
        <li>
          <span class="text-orange  mx-1 ">PERSIST</span>
        </li>
      
        <li>
          <span class="text-orange  mx-1 ">PROPERTY CHANGE</span>
        </li>
      
        <li>
          <span class="text-orange  mx-1 ">PROPERTYCHANGEEVENT</span>
        </li>
      
        <li>
          <span class="text-orange  ml-1 ">UPDATING</span>
        </li>
      
    </ul>
  </div>


  <div class="flex items-center text-sm font-normal text-darkgray whitespace-nowrap">
    Aug 03, 2010
  </div>

  <article class="my-8 prose-sm prose text-green-700 sm:prose">
  <ul>
  <li><a href="/flextrine-tutorial-crud-in-a-simple-flex-4-address-book-introduction/">Introduction</a></li>
  <li><a href="/flextrine-tutorial-crud-in-a-simple-flex-4-address-book-setting-up-the-server/">Setting up the server</a></li>
  <li><a href="/flextrine-tutorial-crud-in-a-simple-flex-4-address-book-creating-the-entities/">Creating the entities</a></li>
  <li><a href="/flextrine-tutorial-crud-in-a-simple-flex-4-address-book-creating-the-database-schema/">Creating the database schema</a></li>
  <li><a href="/flextrine-tutorial-crud-in-a-simple-flex-4-address-book-loading-the-entities/">Loading the entities</a></li>
  <li><a href="/flextrine-tutorial-crud-in-a-simple-flex-4-address-book-creating-new-entities/">Creating new entities</a></li>
  <li><a href="/flextrine-tutorial-crud-in-a-simple-flex-4-address-book-deleting-entities/">Deleting entities</a></li>
  <li><a href="/flextrine-tutorial-crud-in-a-simple-flex-4-address-book-updating-entities/">Updating entities</a></li>
  <li><a href="/flextrine-tutorial-crud-in-a-simple-flex-4-address-book-conclusion/">Conclusion</a></li>
</ul>

<p>Once an entity is in an EntityRepository (either because it was loaded from the database or it was persisted) it is known as a <strong>MANAGED</strong> entity.  This means that Flextrine will constantly watch the entity to see if anything changes, and if so will mark the entity for updating on the next flush().</p>

<p>Therefore updating entities is extremely simple – as long as the entity is managed there is literally nothing to do :)</p>

<p>Lets create an editor for the ContactGroups (in the same directory as Main.mxml):</p>

<h4 id="contactgroupeditormxml">ContactGroupEditor.mxml</h4>

<div class="language-mxml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;s:Group</span> <span class="na">xmlns:fx=</span><span class="s">"http://ns.adobe.com/mxml/2009"</span>
         <span class="na">xmlns:s=</span><span class="s">"library://ns.adobe.com/flex/spark"</span>
         <span class="na">xmlns:mx=</span><span class="s">"library://ns.adobe.com/flex/mx"</span><span class="nt">&gt;</span>

  <span class="nt">&lt;fx:Script&gt;</span>
  <span class="cp">&lt;![CDATA[</span>
    <span class="kr">import</span> <span class="nx">vo</span><span class="p">.</span><span class="nx">ContactGroup</span><span class="o">;</span>
    
    <span class="p">[</span><span class="nx">Bindable</span><span class="p">]</span>
    <span class="kr">public</span> <span class="kd">var</span> <span class="nx">contactGroup</span><span class="o">:</span><span class="nx">ContactGroup</span><span class="o">;</span>
    
  <span class="cp">]]&gt;</span>
  <span class="nt">&lt;/fx:Script&gt;</span>
  
  <span class="nt">&lt;mx:Form</span> <span class="na">labelWidth=</span><span class="s">"150"</span> <span class="na">width=</span><span class="s">"100%"</span> <span class="na">height=</span><span class="s">"100%"</span><span class="nt">&gt;</span>
  
  <span class="nt">&lt;mx:FormHeading</span> <span class="na">label=</span><span class="s">"Edit group"</span> <span class="nt">/&gt;</span>
  
  <span class="nt">&lt;mx:FormItem</span> <span class="na">label=</span><span class="s">"Name"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;s:TextInput</span> <span class="na">text=</span><span class="s">"</span><span class="p">@{</span><span class="nx">contactGroup</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="s">"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/mx:FormItem&gt;</span>
  
  <span class="nt">&lt;/mx:Form&gt;</span>
<span class="nt">&lt;/s:Group&gt;</span>
</code></pre></div></div>

<p>The component takes a <em>contactGroup</em> and provides a TextInput that edits its <em>name</em> attribute using Flex 4 two-way databinding.  In fact you need to be careful with two-way databinding on some components (e.g. DateChooser) as it can cause unnecessary updates, but it works fine for Spark’s TextInput.</p>

<p>Now we need to add the ContactGroupEditor into Main.mxml:</p>

<div class="language-mxml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;s:VGroup</span> <span class="na">width=</span><span class="s">"100%"</span> <span class="na">height=</span><span class="s">"100%"</span><span class="nt">&gt;</span>
  <span class="c">&lt;!-- The editors --&gt;</span>
  <span class="nt">&lt;local:ContactGroupEditor</span> <span class="na">contactGroup=</span><span class="s">"</span><span class="p">{</span><span class="nx">tree</span><span class="p">.</span><span class="nx">selectedItem</span> <span class="nx">as</span> <span class="nx">ContactGroup</span><span class="p">}</span><span class="s">"</span> <span class="na">enabled=</span><span class="s">"</span><span class="p">{</span><span class="nx">tree</span><span class="p">.</span><span class="nx">selectedItem</span> <span class="k">is</span> <span class="nx">ContactGroup</span><span class="p">}</span><span class="s">"</span> <span class="nt">/&gt;</span>
</code></pre></div></div>

<p>And that’s it for the group editor.  When we select a <em>ContactGroup</em> in the tree, the <em>ContactGroupEditor</em> becomes enabled, and the selected item is passed to the editor’s <em>contactGroup</em> attribute.  Flex updates the <em>contactGroup</em>’s <em>name</em> attribute when we change it in the editor and Flextrine automatically picks up on the change and marks the entity for updating.  On the next flush() the changes will be written to the database.</p>

<p>Now for the <code class="language-plaintext highlighter-rouge">ContactEditor</code>.</p>

<h3 id="contacteditormxml">ContactEditor.mxml</h3>

<div class="language-mxml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;s:Group</span> <span class="na">xmlns:fx=</span><span class="s">"http://ns.adobe.com/mxml/2009"</span>
         <span class="na">xmlns:s=</span><span class="s">"library://ns.adobe.com/flex/spark"</span>
         <span class="na">xmlns:mx=</span><span class="s">"library://ns.adobe.com/flex/mx"</span><span class="nt">&gt;</span>

  <span class="nt">&lt;fx:Script&gt;</span>
  <span class="cp">&lt;![CDATA[</span>
    <span class="kr">import</span> <span class="nx">org</span><span class="p">.</span><span class="nx">davekeen</span><span class="p">.</span><span class="nx">flextrine</span><span class="p">.</span><span class="nx">orm</span><span class="p">.</span><span class="nx">EntityManager</span><span class="o">;</span>
    <span class="kr">import</span> <span class="nx">vo</span><span class="p">.</span><span class="nx">ContactGroup</span><span class="o">;</span>
    <span class="kr">import</span> <span class="nx">vo</span><span class="p">.</span><span class="nx">Contact</span><span class="o">;</span>
    
    <span class="p">[</span><span class="nx">Bindable</span><span class="p">]</span>
    <span class="kr">public</span> <span class="kd">var</span> <span class="nx">contact</span><span class="o">:</span><span class="nx">Contact</span><span class="o">;</span>
  <span class="cp">]]&gt;</span>
  <span class="nt">&lt;/fx:Script&gt;</span>
  
  <span class="nt">&lt;mx:Form</span> <span class="na">labelWidth=</span><span class="s">"150"</span> <span class="na">width=</span><span class="s">"100%"</span> <span class="na">height=</span><span class="s">"100%"</span><span class="nt">&gt;</span>
  
    <span class="nt">&lt;mx:FormHeading</span> <span class="na">label=</span><span class="s">"Edit contact"</span> <span class="nt">/&gt;</span>
    
    <span class="nt">&lt;mx:FormItem</span> <span class="na">label=</span><span class="s">"Name"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;s:TextInput</span> <span class="na">text=</span><span class="s">"</span><span class="p">@{</span><span class="nx">contact</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="s">"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/mx:FormItem&gt;</span>
    
    <span class="nt">&lt;mx:FormItem</span> <span class="na">label=</span><span class="s">"Telephone number"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;s:TextInput</span> <span class="na">text=</span><span class="s">"</span><span class="p">@{</span><span class="nx">contact</span><span class="p">.</span><span class="nx">telephoneNumber</span><span class="p">}</span><span class="s">"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/mx:FormItem&gt;</span>
    
    <span class="nt">&lt;mx:FormItem</span> <span class="na">label=</span><span class="s">"Birthday"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;mx:DateChooser</span> <span class="na">selectedDate=</span><span class="s">"</span><span class="p">{</span><span class="nx">contact</span><span class="p">.</span><span class="nx">birthday</span><span class="p">}</span><span class="s">"</span> <span class="na">change=</span><span class="s">"contact.birthday = event.currentTarget.selectedDate"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/mx:FormItem&gt;</span>
    
    <span class="nt">&lt;mx:FormItem</span> <span class="na">label=</span><span class="s">"Group"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;s:DropDownList</span> <span class="na">dataProvider=</span><span class="s">"</span><span class="p">{</span><span class="nx">EntityManager</span><span class="p">.</span><span class="nx">getInstance</span><span class="p">().</span><span class="nx">getRepository</span><span class="p">(</span><span class="nx">ContactGroup</span><span class="p">).</span><span class="nx">entities</span><span class="p">}</span><span class="s">"</span>
                      <span class="na">selectedItem=</span><span class="s">"</span><span class="p">{</span><span class="nx">contact</span><span class="p">.</span><span class="nx">contactGroup</span><span class="p">}</span><span class="s">"</span>
                      <span class="na">change=</span><span class="s">"contact.setContactGroup(event.currentTarget.selectedItem);"</span>
                      <span class="na">labelField=</span><span class="s">"name"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/mx:FormItem&gt;</span>
  
  <span class="nt">&lt;/mx:Form&gt;</span>
<span class="nt">&lt;/s:Group&gt;</span>
</code></pre></div></div>

<p>The contact editor is marginally more complicated, but still fairly simple.  A few points:</p>

<ul>
  <li>Note is that as mentioned above we don’t use two-way databinding on any component apart from TextInput.</li>
  <li>Although it is perfectly legal to retrieve the singleton EntityManager in the ContactEditor as we have done in the DropDownList dataProvider, in a real application we probably wouldn’t do this as it breaks encapsulation.  I’ve done it here for the sake of simplicity :)</li>
</ul>

<p>Finally we need to add the editor to Main.mxml:</p>

<div class="language-mxml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>...
<span class="nt">&lt;s:VGroup</span> <span class="na">width=</span><span class="s">"100%"</span> <span class="na">height=</span><span class="s">"100%"</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- The editors --&gt;</span>
    <span class="nt">&lt;local:ContactGroupEditor</span> <span class="na">contactGroup=</span><span class="s">"</span><span class="p">{</span><span class="nx">tree</span><span class="p">.</span><span class="nx">selectedItem</span> <span class="nx">as</span> <span class="nx">ContactGroup</span><span class="p">}</span><span class="s">"</span> <span class="na">enabled=</span><span class="s">"</span><span class="p">{</span><span class="nx">tree</span><span class="p">.</span><span class="nx">selectedItem</span> <span class="k">is</span> <span class="nx">ContactGroup</span><span class="p">}</span><span class="s">"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;mx:HRule</span> <span class="na">width=</span><span class="s">"100%"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;local:ContactEditor</span> <span class="na">contact=</span><span class="s">"</span><span class="p">{</span><span class="nx">tree</span><span class="p">.</span><span class="nx">selectedItem</span> <span class="nx">as</span> <span class="nx">Contact</span><span class="p">}</span><span class="s">"</span> <span class="na">enabled=</span><span class="s">"</span><span class="p">{</span><span class="nx">tree</span><span class="p">.</span><span class="nx">selectedItem</span> <span class="k">is</span> <span class="nx">Contact</span><span class="p">}</span><span class="s">"</span> <span class="nt">/&gt;</span>
...
</code></pre></div></div>

<p>An that’s it!  A simple but fully functioning, database aware Flex application.</p>

<p>And now, <a href="/flextrine-tutorial-crud-in-a-simple-flex-4-address-book-conclusion/">the thrilling conclusion</a>.</p>

</article>
</div>

  </body>

  <script src="https://unpkg.com/smartphoto@1.1.0/js/smartphoto.min.js"></script>
  <script src="https://unpkg.com/flickity@2/dist/flickity.pkgd.min.js"></script>
</html>
